{% extends "base.html" %}
{% set title = "Service Desk" %}

{% from "_page_header.html" import page_header %}

{% block content %}
<div class="page">
  {% call page_header("사내 요청 관리", "Service Desk", "사내 요청을 한곳에서 관리합니다.") %}
    <div class="sd-toggle" role="tablist">
      <button class="sd-toggle-btn is-active" data-mode="category" type="button">카테고리</button>
      <button class="sd-toggle-btn" data-mode="status" type="button">상태</button>
    </div>
  {% endcall %}

  <section class="sd-summary">
    <div class="sd-summary-grid" id="sd-summary-grid"></div>
  </section>

  <section class="sd-filters">
    <div class="sd-filter-row">
      <div class="sd-filter-group">
        <label class="form-label" for="sd-sort">정렬</label>
        <select id="sd-sort" class="form-select">
          <option value="newest">최신순</option>
          <option value="pending_oldest">대기 오래된 순</option>
          <option value="urgency">긴급도순</option>
        </select>
      </div>
      <div class="sd-filter-group">
        <label class="form-label" for="sd-category">카테고리</label>
        <select id="sd-category" class="form-select">
          <option value="">전체</option>
          <option value="IT">IT 지원</option>
          <option value="PURCHASE">물품 구매</option>
          <option value="FACILITY">시설 수리</option>
        </select>
      </div>
      <div class="sd-filter-group">
        <label class="form-label" for="sd-status">상태</label>
        <select id="sd-status" class="form-select">
          <option value="">전체</option>
          <option value="PENDING">대기</option>
          <option value="APPROVED">승인</option>
          <option value="REJECTED">반려</option>
          <option value="COMPLETED">완료</option>
        </select>
      </div>
      <div class="sd-filter-group sd-filter-search">
        <label class="form-label" for="sd-q">검색</label>
        <div class="sd-search">
          <input id="sd-q" class="form-input" type="search" placeholder="검색(제목/신청자)" />
        </div>
      </div>
      <div class="sd-filter-actions">
        <button class="btn sd-btn-primary" id="sd-new-ticket" type="button">+ 새 요청</button>
      </div>
    </div>
    <div class="sd-filter-state">
      <div class="sd-filter-pills" id="sd-filter-pills"></div>
      <button class="btn sd-btn-ghost" id="sd-reset" type="button">전체 초기화</button>
    </div>
  </section>

  <section class="sd-table">
    <div class="sd-table-head">
      <div class="sd-table-title-row">
  <div class="sd-section-title">요청 목록</div>
  <div class="sd-section-meta" id="sd-total-count">총 0건</div>
</div>
      <div class="sd-mode-toggle" role="tablist">
        <button class="sd-mode-btn is-active" data-mode="user" type="button">사용자 모드</button>
        <button class="sd-mode-btn" data-mode="admin" type="button">관리자 모드</button>
      </div>
    </div>
    <div class="sd-table-wrap">
      <table class="sd-table-table">
        <thead>
          <tr>
            <th>제목</th>
            <th>긴급도</th>
            <th>상태</th>
            <th>카테고리</th>
            <th>담당팀</th>
            <th>신청자</th>
            <th>신청일</th>
          </tr>
        </thead>
        <tbody id="sd-table-body"></tbody>
      </table>
    </div>
  </section>
</div>

<div class="sd-overlay" id="sd-overlay" aria-hidden="true"></div>
<div class="sd-panel" id="sd-panel" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="sd-panel-header">
    <div>
      <div class="sd-panel-title">새 서비스 요청</div>
    </div>
    <button class="sd-icon-btn" id="sd-panel-close" type="button" aria-label="닫기">X</button>
  </div>
  <form class="sd-form form-stack" id="sd-form">
    <label class="form-label" for="sd-form-category">카테고리</label>
    <select id="sd-form-category" name="category" class="form-select" required>
      <option value="IT">IT 지원</option>
      <option value="PURCHASE">물품 구매</option>
      <option value="FACILITY">시설 수리</option>
    </select>

    <label class="form-label" for="sd-form-title">요청 항목</label>
    <input id="sd-form-title" name="title" class="form-input" type="text" placeholder="예: 맥북 충전기 교체" required />

    <label class="form-label" for="sd-form-description">상세 사유</label>
    <textarea id="sd-form-description" name="description" class="form-textarea" rows="4" placeholder="사유/증상 설명"></textarea>

    <div class="sd-form-block">
      <span class="form-label">긴급도</span>
      <div class="sd-radio-group">
        <label class="sd-radio"><input type="radio" name="urgency" value="LOW" />낮음</label>
        <label class="sd-radio"><input type="radio" name="urgency" value="NORMAL" checked />보통</label>
        <label class="sd-radio"><input type="radio" name="urgency" value="URGENT" />긴급</label>
      </div>
    </div>

    <label class="form-label" for="sd-form-attachment">첨부 파일 (선택)</label>
    <input id="sd-form-attachment" name="attachment" class="form-input" type="file" />

    <div class="sd-form-actions">
      <button class="btn sd-btn-ghost" id="sd-cancel" type="button">취소</button>
      <button class="btn sd-btn-primary" type="submit">요청하기</button>
    </div>
  </form>
</div>

<script src="{{ url_for('static', filename='js/service_desk.js') }}"></script>
{% endblock %}
